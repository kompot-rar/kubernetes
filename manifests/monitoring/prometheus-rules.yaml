apiVersion: monitoring.coreos.com/v1
kind: PrometheusRule
metadata:
  name: sla-tracking
  namespace: monitoring
  labels:
    release: monitoring-kube-prometheus
spec:
  groups:
  - name: sla_tracking
    interval: 5m
    rules:
      # Średnia dostępność z ostatnich 30 dni (wartość 0-1)
      - record: sla:availability:30d
        expr: avg_over_time(probe_success{job="blackbox", instance="https://devops.mrozy.org"}[30d])
      
      # Dzienna dostępność (do kalendarza/wykresu)
      - record: sla:availability:daily
        expr: avg_over_time(probe_success{job="blackbox", instance="https://devops.mrozy.org"}[1d])
